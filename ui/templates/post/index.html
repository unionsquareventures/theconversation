{% extends '../base.html' %}
{% block content %}
<div id="main" role="main">
    <section class="featured-feed clearfix">
        <ul class="tabs">
            <li><a class="current" href="/featured_posts">Featured</a></li>
        </ul>
        <ul class="feed">
            {% for post in featured_posts %}
            <li>
                <div class="content">
                  <a class="title" href="/posts/{{ post.slug }}">{{ post.title }}</a>
                  {% if post.url %}
                      <a href="{{ post.url }}" class="source" target="_blank">{{ urlparse(post.url).netloc }}</a>
                  {% else %}
                      <a href="/posts/{{ post.slug }}" class="source" target="_blank">usv.com</a>
                  {% end %}
                  <div class="excerpt">{{ post.body_truncated }}</div>
                  <div class="meta">
                      <div class="thumbnail">
                        <a href="http://www.twitter.com/{{ post.user.username }}" target="_blank">
                          <img src="{{ twitter_avatar_size(post.user.profile_image_url_https, 'normal') }}" alt="thumbnail">
                        </a>
                      </div>
                      <a class="username" href="http://www.twitter.com/{{ post.user.username }}" target="_blank">@{{ post.user.username }}</a>
                      <span class="time">{{ post.date_created.strftime("%B %d, %Y") }}</span>
                      {% module ajax_upvote_link(post=post) %}
                      <a class="comments-count" href="/posts/{{ post.slug }}#disqus_thread">0 comments</a>
                  </div>
                </div>
            </li>
            {% end %}
        </ul><!--end of feed-->
        <a class="more-link" href="/featured_posts">Featured Posts</a>
    </section><!--end of featured-feed-->

    <section class="hot-newest-feed">
        <ul class="tabs">
          <li><a class="{{ 'current' if sort_by == 'hot' else '' }}" href="?sort_by=hot">Hot</a></li>
          <li><a class="{{ 'current' if sort_by == 'new' else '' }}" href="?sort_by=new">Newest</a></li>
        </ul>

        <ul class="feed">
            {% if count == 0 and rstart != 0 %}
                <a href="/?sort_by={{ sort_by }}" class="new_posts_link">New posts ({{ rstart }})</a>
            {% end %}

            {% for post in posts %}
            <li>
                <div class="thumbnail">
                  <a href="http://www.twitter.com/{{ post.user.username }}" target="_blank">
                    <img src="{{ twitter_avatar_size(post.user.profile_image_url_https, 'normal') }}" alt="thumbnail">
                  </a>
                </div>
                <div class="content">
                  {% if post.url %}
                      <a class="title" href="{{ post.url }}">{{ post.title }}</a>
                      <a href="{{ post.url }}" class="source" target="_blank">{{ urlparse(post.url).netloc }}</a>
                  {% else %}
                      <a class="title" href="/posts/{{ post.slug }}">{{ post.title }}</a>
                      <a href="/posts/{{ post.slug }}" class="source" target="_blank">usv.com</a>
                  {% end %}
                  <div class="meta">
                    <a class="username" href="http://www.twitter.com/{{ post.user.username }}" target="_blank">@{{ post.user.username }}</a>
                      <span class="time">{{ post.date_created.strftime("%B %d, %Y") }}</span>
                      {% module ajax_upvote_link(post=post) %}
                      <a class="comments-count" href="/posts/{{ post.slug }}#disqus_thread">0 comments</a>
                  </div>
                </div>
              </li>
              {% end %}
        </ul><!--end of feed-->

        <ul id="pagination">
          {% if rstart > 0 %}
            <li>
              <a href="?sort_by={{ sort_by }}&anchor={{ posts[0].id }}&action=before&count={{ count - per_page }}">Prev</a>
            </li>
          {% end %}
          {% if rend < num_posts - 1 %}
            <li>
              <a href="?sort_by={{sort_by }}&anchor={{ posts[-1].id }}&action=after&count={{ count + per_page }}">Next</a>
            </li>
          {% end %}
        </ul>
    </section>
  </div><!--end of main-->
{% end %}
